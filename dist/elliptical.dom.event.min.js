!function(t,n){"undefined"!=typeof module&&module.exports?module.exports=n():"function"==typeof define&&define.amd?define([],n):(t.elliptical=t.elliptical||{},t.elliptical.DomEvent=n(),t.returnExports=t.elliptical.DomEvent)}(this,function(){function t(t,i){this._events=[],this._node=null,this._context=this,this._scrollOn=!1,t&&void 0!==t&&void 0!==t.nodeName&&(this._node=$(t)),i&&void 0!==i&&(this._context=i),this.event=function(t,n,e,i){var o=this._context,s=arguments.length;2===s&&(i=n,n=t,t=this._node,e=null),3===s&&("string"==typeof t?(i=e,e=n,n=t,t=this._node):(i=e,e=null));var l={};l.element=t,l.event=n,l.selector=e,l.callback=i,this._events.push(l),e?t.on(n,e,function(){var t=[].slice.call(arguments);i&&i.apply(o,t)}):t.on(n,function(){var t=[].slice.call(arguments);i&&i.apply(o,t)})},this.unbind=function(){for(var t=this._events,n=t.length,e=0;n>e;e++){var i=t[e];i.selector?i.element.off(i.event,i.selector):i.element.off(i.event)}t.length=0},this.onScroll=function(t){if(!this._scrollOn){this._scrollOn=!0;var i=function(){var n=$(document).height()-$(window).height();$(window).scrollTop()>n-e&&t&&t()},o=function(){window.requestAnimationFrame(i)};this.event($(window),n,o)}},this.scrollOff=function(){if(this._scrollOn){this._scrollOn=!1;for(var t=this._events,e=t.length,i=0;e>i;i++){var o=t[i];if(o.event===n){o.selector?o.element.off(o.event,o.selector):o.element.off(o.event),t.splice(i);break}}}},this.register=function(t){var n=this;t.length&&t.forEach(function(t){n._isRegistered(t)||document.registerElement(t)})},this.load=function(t,n){var e=new Image,i=$(e);i.bind("load.newImg",function(){i.unbind("load.newImg"),n&&n(this)}),e.src=t},this.preload=function(t,n){"function"==typeof t&&(n=t,t=this._node);var e=[],i={},o=$(t),s=o.find("img"),l=s.length,c=0;return 0===l?(n&&n(null),!1):($.each(s,function(t,o){var s=new Image,r=$(s);r.bind("load.image",function(t){c++,e.push(s),r.unbind("load.image"),c===l&&n&&(i.images=e,i.length=c,n(i))}),s.src=o.src}),!0)},this.find=function(t){return this._node?this._node.find(t):null},this.dispose=function(){this.unbind(),this.scrollOff()},this._click=function(){return"ontouchend"in document?"touchstart":"click"},this._press=function(){return"ontouchend"in document?"touchend":"click"},this._tap=function(){return"ontouchend"in document?"tap":"click"},this._getEvent=function(t){return"click"===t?this._click():"press"===t?this._press():"tap"===t?this._tap():t},this._bindEvent=function(t,n){var e,i=this._node,o=t[n],s=n.split("@"),l=s.length;if(1===l)e=this._getEvent(s[0]),this.event(i,e,o);else if(2===l){var c=s[0];e=this._getEvent(s[1]),"document"===c&&this.event($(document),e,o),"window"===c?this.event($(window),e,o):this.event(i,e,c,o)}},this._isRegistered=function(t){return document.createElement(t).constructor!==HTMLElement}}var n="scroll.infinite",e=100;return t});